webpackJsonp([3],{"3QDu":function(e,t){},OlzR:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("cMGX"),l=r("Dod7"),s={data:function(){return{uploadUrl:l.a.uploadUrl,avatarUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}},methods:{handleAvatarSuccess:function(e,t){this.avatarUrl=URL.createObjectURL(t.raw),console.log(this.avatarUrl)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},resetUrl:function(){this.avatarUrl="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"},getAvatarUrl:function(){return this.avatarUrl}}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-upload",{staticClass:"avatar-uploader",attrs:{action:this.uploadUrl,"show-file-list":!1,"on-success":this.handleAvatarSuccess,"before-upload":this.beforeAvatarUpload}},[t("el-avatar",{staticStyle:{margin:"center"},attrs:{size:120,src:this.avatarUrl}})],1)},staticRenderFns:[]};var i={components:{Avatar:r("VU/8")(s,o,!1,function(e){r("3QDu")},null,null).exports},data:function(){var e=this;return{dialogVisible:!1,ruleForm:{username:"",password:"",checkPassword:"",name:"",job:"",email:"",register:new Date,status:"已启用",role:"普通用户",phone:"",avatar:""},rules:{username:[{required:!0,validator:function(e,t,r){if(!t)return r(new Error("用户名不能为空"));setTimeout(function(){t.length<6||t.length>12?r(new Error("用户名不得小于6个或大于20个字符")):r()},1e3)},trigger:"blur"}],password:[{required:!0,validator:function(t,r,a){""==r?a(new Error("请输入密码")):(""!==e.ruleForm.checkPassword&&e.$refs.ruleForm.validateField("checkPassword"),a())},trigger:"blur"}],checkPassword:[{required:!0,validator:function(t,r,a){""==r?a(new Error("请再次输入密码")):r!==e.ruleForm.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],name:[{required:!0,message:"请填入用户姓名",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],phone:[{required:!0,message:"请填入联系电话",trigger:"blur"},{min:11,max:11,message:"请输入正确的手机号",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(r){r&&(t.ruleForm.avatar=t.$refs.avatar.getAvatarUrl(),t.ruleForm.password=t.$crypt.setEncrypt(t.ruleForm.password),t.$api.addUser(t.ruleForm).then(function(r){if(200!=r.data.status)return t.$message.error("提交失败!"),!1;t.$parent.userList(1),t.resetForm(e),t.$message({message:"提交成功!",type:"success"})}))})},resetForm:function(e){this.$refs[e].resetFields(),this.$refs.avatar.resetUrl()}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.dialogVisible,top:"5vh",width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("template",{slot:"title"},[r("span",[e._v("添加用户")]),e._v(" "),r("el-divider")],1),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{"margin-top":"-15px"},attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px",size:"mini"}},[r("el-row",[r("el-col",{attrs:{span:13}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPassword"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.checkPassword,callback:function(t){e.$set(e.ruleForm,"checkPassword",t)},expression:"ruleForm.checkPassword"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:11}},[r("div",{staticStyle:{"text-align":"center"}},[r("Avatar",{ref:"avatar"})],1)])],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"部门职务",prop:"job"}},[r("el-input",{model:{value:e.ruleForm.job,callback:function(t){e.$set(e.ruleForm,"job",t)},expression:"ruleForm.job"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[r("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[r("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户权限",prop:"role"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.role,callback:function(t){e.$set(e.ruleForm,"role",t)},expression:"ruleForm.role"}},[r("el-option",{attrs:{label:"普通用户",value:"普通用户"}}),e._v(" "),r("el-option",{attrs:{label:"高级用户",value:"高级用户"}}),e._v(" "),r("el-option",{attrs:{label:"管理员用户",value:"管理员用户"}}),e._v(" "),r("el-option",{attrs:{label:"测试用户",value:"测试用户"}})],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户状态",prop:"status"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}},[r("el-option",{attrs:{label:"已启用",value:"已启用"}}),e._v(" "),r("el-option",{attrs:{label:"已关闭",value:"已关闭"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"登记日期",prop:"register"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",disabled:""},model:{value:e.ruleForm.register,callback:function(t){e.$set(e.ruleForm,"register",t)},expression:"ruleForm.register"}})],1)],1)],1),e._v(" "),r("el-form-item",{staticStyle:{"text-align":"center","margin-top":"15px"}},[r("el-button",{staticStyle:{"font-size":"15px"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),r("el-button",{staticStyle:{"font-size":"15px"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],2)},staticRenderFns:[]};var u=r("VU/8")(i,n,!1,function(e){r("yOHW")},"data-v-b3a9bb32",null).exports,c={components:{Pagination:a.a,AddUser:u},data:function(){return{input:"",tableData:[],total:10,pageSize:1,type:1,dialogVisible:!1,currentPage:1}},methods:{changePage:function(e){this.currentPage=e,1==this.type?this.userList(e):this.tableData=this.list.slice(3*(e-1),3*e)},userList:function(e){var t=this;this.$api.getUserList({page:e}).then(function(e){200==e.data.status&&(t.$date.dateFilter(e.data.data),t.tableData=e.data.data,t.total=e.data.total,t.pageSize=e.data.pageSize)})},changeDialog:function(){this.dialogVisible=!1},addUser:function(){this.$refs.dialog.dialogVisible=!0},delUser:function(e,t){var r=this;this.$confirm("此操作将彻底删除用户信息，是否继续?","提示",{confirmButtonText:"确定",cancelButton:"取消",type:"warning"}).then(function(){r.$api.delUser({id:t.id}).then(function(e){200==e.data.status?(r.userList(1),r.$message({message:"删除成功!",type:"success"})):r.$message.error("删除失败!")})}).catch(function(){r.$message({type:"info",message:"已取消删除!"})})},searchUser:function(){var e=this;this.currentPage=1;var t=this.input;if(!t)return this.userList(1),void(this.type=1);this.$api.getSearchUser({search:t}).then(function(t){200==t.data.status?(e.total=t.data.result.length,e.tableData=t.data.result.slice(0,3),e.list=t.data.result,e.type=2):(e.tableData=[],e.total=1,e.pageSize=1)})},editUser:function(e,t){console.log("编辑用户")}},created:function(){this.userList(1)}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"user"}},[r("div",{attrs:{id:"header"}},[r("el-input",{attrs:{placeholder:"请输入内容"},on:{change:e.searchUser},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.searchUser}},[e._v("查询用户")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("增加用户")])],1),e._v(" "),r("div",{attrs:{id:"wrapper"}},[r("el-table",{attrs:{data:e.tableData,"cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"}}},[r("el-table-column",{attrs:{type:"selection",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"用户名",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"姓名",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"job",label:"部门职务",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phone",label:"联系电话",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"email",label:"电子邮箱",width:"150","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"role",label:"用户权限",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"status",label:"用户状态",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.editUser(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.delUser(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("Pagination",{attrs:{total:e.total,pageSize:e.pageSize,currentPage:e.currentPage},on:{changePage:e.changePage}}),e._v(" "),r("AddUser",{ref:"dialog"})],1)},staticRenderFns:[]};var m=r("VU/8")(c,p,!1,function(e){r("Wj3T")},"data-v-8a527678",null);t.default=m.exports},Wj3T:function(e,t){},yOHW:function(e,t){}});
//# sourceMappingURL=3.4a5cf7b568d32b2d623c.js.map